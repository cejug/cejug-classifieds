<?xml version="1.0" encoding="utf-8"?>
<mx:Panel title="Category" horizontalAlign="center" verticalGap="0" paddingTop="8" paddingBottom="8" 
    xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%"
    xmlns:category="net.java.dev.cejug.classifieds.admin.view.category.*"
    creationComplete="categoryService.init(event)">
    <category:Category id="categoryService" />
    <mx:VBox width="100%" height="100%" id="vbCategory">
        <mx:Panel id="pCategory" title="Categories" width="100%" height="100%">
            <mx:DataGrid id="categories" dataProvider="{categoryService.categoryDataProvider}" width="100%" height="100%" allowMultipleSelection="false">
                <mx:columns>
                    <mx:DataGridColumn headerText="Id" dataField="id"/>
                    <mx:DataGridColumn headerText="Name" dataField="name"/>
                    <mx:DataGridColumn headerText="Description" dataField="description"/>
                    <mx:DataGridColumn headerText="Available" dataField="available"  />
                </mx:columns>
            </mx:DataGrid>

            <mx:ControlBar>
                <mx:Button label="New"  click="categoryService.loadNewCategory()" />
                <mx:Button label="Update" click="categoryService.loadUpdateCategory()" enabled="{Boolean(categories.selectedItem)}" />
                <mx:Button label="Delete" enabled="{Boolean(categories.selectedItem)}" />
            </mx:ControlBar>
        </mx:Panel>
    </mx:VBox>

    <mx:states>
        <mx:State name="createCategory">
            <mx:AddChild relativeTo="{vbCategory}">
                <mx:Panel id="pNewCategory" title="New Category" width="100%">
                    <mx:Form width="100%" id="fNewCategory">
                        <mx:FormItem label="Name"><mx:TextInput id="fNewCategoryName"/></mx:FormItem>
                        <mx:FormItem label="Description"><mx:TextArea id="fNewCategoryDescription" /></mx:FormItem>
                        <mx:FormItem label="Available"><mx:CheckBox id="fNewCategoryAvailable"/></mx:FormItem>
                    </mx:Form>

                    <mx:ControlBar>
                        <mx:Button label="Save" />
                        <mx:Button label="Cancel"  click="currentState=''"/>
                    </mx:ControlBar>
                </mx:Panel>
            </mx:AddChild>
            <mx:SetProperty target="{pCategory}" name="enabled" value="false"/>
        </mx:State>

        <mx:State name="updateCategory">
            <mx:AddChild relativeTo="{vbCategory}">
                <mx:Panel id="pUpdateCategory" title="Update Category" width="100%">
                    <mx:Form width="100%" id="fUpdateCategory">
                        <mx:FormItem label="Name"><mx:TextInput id="fUpdateCategoryName" text="{categoryService.categoryEntity.name}"/></mx:FormItem>
                        <mx:FormItem label="Description"><mx:TextArea id="fUpdateCategoryDescription" text="{categoryService.categoryEntity.description}"/></mx:FormItem>
                        <mx:FormItem label="Available"><mx:CheckBox id="fUpdateCategoryAvailable" selected="{categoryService.categoryEntity.available==1}" /></mx:FormItem>
                    </mx:Form>

                    <mx:ControlBar>
                        <mx:Button label="Save" />
                        <mx:Button label="Cancel"  click="currentState=''"/>
                    </mx:ControlBar>
                </mx:Panel>
            </mx:AddChild>
            <mx:SetProperty target="{pCategory}" name="enabled" value="false"/>
        </mx:State>
    </mx:states>
</mx:Panel>
